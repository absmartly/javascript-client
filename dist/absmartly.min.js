!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.absmartly=e():t.absmartly=e()}(self,(function(){return function(){var t={899:function(t,e,n){"use strict";var r;e.default=void 0;var o={Client:((r=n(225))&&r.__esModule?r:{default:r}).default};e.default=o},225:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,o=(r=n(204))&&r.__esModule?r:{default:r};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._opts=Object.assign({endpoint:void 0,apiKey:void 0,environment:void 0,agent:"javascript-client",application:{name:"default",version:0},retries:5,timeout:500},e);for(var n=0,r=["apiKey","endpoint","environment"];n<r.length;n++){var o=r[n];if(!(o in this._opts)||void 0===this._opts[o])throw new Error("Missing '".concat(o,"' in options argument"));var i=this._opts[o];if("string"!=typeof i||0===i.length)throw new Error("Invalid '".concat(o,"' in options argument"))}this._delay=Math.max(10,this._opts.timeout/(1<<this._opts.retries))}var e,n;return e=t,(n=[{key:"createContext",value:function(t){var e={agent:this._opts.agent,environment:this._opts.environment,application:t.application||this._opts.application,units:t.units};return this.post("/context",e)}},{key:"refreshContext",value:function(t){var e={guid:t.guid,agent:this._opts.agent,environment:this._opts.environment,application:t.application||this._opts.application,units:t.units};return this.post("/context",e)}},{key:"publish",value:function(t){var e={agent:this._opts.agent,environment:this._opts.environment,guid:t.guid,application:t.application||this._opts.application,units:t.units};return Array.isArray(t.goals)&&t.goals.length>0&&(e.goals=t.goals),Array.isArray(t.exposures)&&t.exposures.length>0&&(e.exposures=t.exposures),Array.isArray(t.attributes)&&t.attributes.length>0&&(e.attributes=t.attributes),this.put("/context",e)}},{key:"request",value:function(t,e,n){var r=this,i="".concat(this._opts.endpoint).concat(e),s=function(){return(0,o.default)(i,{method:t,headers:{"Content-Type":"application/json","X-API-Key":r._opts.apiKey},body:JSON.stringify(n,null,0)}).then((function(t){if(!t.ok){var e=t.status>=400&&t.status<500;return t.text().then((function(n){var r=new Error(null!==n&&n.length>0?n:t.statusText);return r._bail=e,Promise.reject(r)}))}return t.json()}))},u=function(t){return new Promise((function(e){setTimeout(e,t)}))};return function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return s().catch((function(s){if(s._bail||o>=e||i>=n)return Promise.reject(s);var a=(1<<o)*r._delay+.5*Math.random()*r._delay;return i+a>n&&(a=n-i),u(a).then((function(){return t(e,n,o+1,i+a)}))}))}(this._opts.retries,this._opts.timeout)}},{key:"post",value:function(t,e){return this.request("POST",t,e)}},{key:"put",value:function(t,e){return this.request("PUT",t,e)}}])&&i(e.prototype,n),t}();e.default=s},204:function(t,e,n){t.exports=self.fetch||(self.fetch=n(869).default||n(869))},869:function(t,e,n){"use strict";function r(t,e){return e=e||{},new Promise((function(n,r){var o=new XMLHttpRequest,i=[],s=[],u={},a=function(){return{ok:2==(o.status/100|0),statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:a,headers:{keys:function(){return i},entries:function(){return s},get:function(t){return u[t.toLowerCase()]},has:function(t){return t.toLowerCase()in u}}}};for(var l in o.open(e.method||"get",t,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(t,e,n){i.push(e=e.toLowerCase()),s.push([e,n]),u[e]=u[e]?u[e]+","+n:n})),n(a())},o.onerror=r,o.withCredentials="include"==e.credentials,e.headers)o.setRequestHeader(l,e.headers[l]);o.send(e.body||null)}))}n.r(e),n.d(e,{default:function(){return r}})}},e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}return n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(899)}().default}));